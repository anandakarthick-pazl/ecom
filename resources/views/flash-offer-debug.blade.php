@extends('layouts.app')\n\n@section('title', 'Flash Offer Debug')\n\n@section('content')\n<div class=\"container mt-4\">\n    <div class=\"row\">\n        <div class=\"col-md-8\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h3><i class=\"fas fa-bug\"></i> Flash Offer Debug Information</h3>\n                </div>\n                <div class=\"card-body\">\n                    <h5>System Status:</h5>\n                    <ul class=\"list-group mb-4\">\n                        <li class=\"list-group-item d-flex justify-content-between align-items-center\">\n                            Service Provider Registered\n                            <span class=\"badge bg-success rounded-pill\">✓</span>\n                        </li>\n                        <li class=\"list-group-item d-flex justify-content-between align-items-center\">\n                            Flash Offer Component Available\n                            <span class=\"badge bg-success rounded-pill\">✓</span>\n                        </li>\n                        <li class=\"list-group-item d-flex justify-content-between align-items-center\">\n                            Storage Link Active\n                            <span class=\"badge bg-{{ file_exists(public_path('storage')) ? 'success' : 'danger' }} rounded-pill\">\n                                {{ file_exists(public_path('storage')) ? '✓' : '✗' }}\n                            </span>\n                        </li>\n                    </ul>\n                    \n                    <h5>Active Flash Offer:</h5>\n                    @if($activeFlashOffer)\n                        <div class=\"alert alert-success\">\n                            <h6><i class=\"fas fa-bolt\"></i> {{ $activeFlashOffer->name }}</h6>\n                            <ul class=\"mb-0\">\n                                <li><strong>ID:</strong> {{ $activeFlashOffer->id }}</li>\n                                <li><strong>Type:</strong> {{ ucfirst($activeFlashOffer->type) }}</li>\n                                <li><strong>Value:</strong> {{ $activeFlashOffer->discount_value_display }}</li>\n                                <li><strong>Active:</strong> {{ $activeFlashOffer->is_active ? 'Yes' : 'No' }}</li>\n                                <li><strong>Flash Offer:</strong> {{ $activeFlashOffer->is_flash_offer ? 'Yes' : 'No' }}</li>\n                                <li><strong>Show Popup:</strong> {{ $activeFlashOffer->show_popup ? 'Yes' : 'No' }}</li>\n                                <li><strong>Start Date:</strong> {{ $activeFlashOffer->start_date->format('Y-m-d H:i:s') }}</li>\n                                <li><strong>End Date:</strong> {{ $activeFlashOffer->end_date->format('Y-m-d H:i:s') }}</li>\n                                <li><strong>Banner Image:</strong> {{ $activeFlashOffer->banner_image ? 'Yes' : 'No' }}</li>\n                                @if($activeFlashOffer->banner_image)\n                                    <li><strong>Image Path:</strong> {{ $activeFlashOffer->banner_image }}</li>\n                                    <li><strong>Image URL:</strong> {{ asset('storage/' . $activeFlashOffer->banner_image) }}</li>\n                                @endif\n                                <li><strong>Banner Title:</strong> {{ $activeFlashOffer->banner_title ?: 'Not set' }}</li>\n                                <li><strong>Popup Delay:</strong> {{ $activeFlashOffer->popup_delay ? ($activeFlashOffer->popup_delay / 1000) . ' seconds' : 'Not set' }}</li>\n                            </ul>\n                        </div>\n                        \n                        @if($activeFlashOffer->banner_image)\n                            <h6>Banner Image Preview:</h6>\n                            <img src=\"{{ asset('storage/' . $activeFlashOffer->banner_image) }}\" \n                                 alt=\"Flash Offer Banner\" \n                                 class=\"img-thumbnail mb-3\" \n                                 style=\"max-width: 300px;\">\n                        @endif\n                    @else\n                        <div class=\"alert alert-warning\">\n                            <i class=\"fas fa-exclamation-triangle\"></i> No active flash offer found.\n                        </div>\n                    @endif\n                    \n                    <h5>All Flash Offers:</h5>\n                    @if($allFlashOffers->count() > 0)\n                        <div class=\"table-responsive\">\n                            <table class=\"table table-sm\">\n                                <thead>\n                                    <tr>\n                                        <th>ID</th>\n                                        <th>Name</th>\n                                        <th>Active</th>\n                                        <th>Flash</th>\n                                        <th>Popup</th>\n                                        <th>Dates</th>\n                                        <th>Image</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    @foreach($allFlashOffers as $offer)\n                                    <tr>\n                                        <td>{{ $offer->id }}</td>\n                                        <td>{{ $offer->name }}</td>\n                                        <td><span class=\"badge bg-{{ $offer->is_active ? 'success' : 'danger' }}\">{{ $offer->is_active ? 'Yes' : 'No' }}</span></td>\n                                        <td><span class=\"badge bg-{{ $offer->is_flash_offer ? 'warning' : 'secondary' }}\">{{ $offer->is_flash_offer ? 'Yes' : 'No' }}</span></td>\n                                        <td><span class=\"badge bg-{{ $offer->show_popup ? 'info' : 'secondary' }}\">{{ $offer->show_popup ? 'Yes' : 'No' }}</span></td>\n                                        <td>{{ $offer->start_date->format('m/d') }} - {{ $offer->end_date->format('m/d') }}</td>\n                                        <td>{{ $offer->banner_image ? '✓' : '✗' }}</td>\n                                    </tr>\n                                    @endforeach\n                                </tbody>\n                            </table>\n                        </div>\n                    @else\n                        <div class=\"alert alert-info\">\n                            No flash offers found in database.\n                        </div>\n                    @endif\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"col-md-4\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5>Quick Actions</h5>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"d-grid gap-2\">\n                        <a href=\"{{ route('admin.offers.create') }}\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-plus\"></i> Create Flash Offer\n                        </a>\n                        \n                        <button onclick=\"clearFlashOfferStorage()\" class=\"btn btn-warning\">\n                            <i class=\"fas fa-trash\"></i> Clear Storage\n                        </button>\n                        \n                        <a href=\"{{ url()->current() }}?debug=flash\" class=\"btn btn-info\">\n                            <i class=\"fas fa-eye\"></i> Force Show Popup\n                        </a>\n                        \n                        <a href=\"{{ route('shop') }}\" class=\"btn btn-success\">\n                            <i class=\"fas fa-external-link-alt\"></i> Visit Shop\n                        </a>\n                        \n                        <a href=\"{{ route('admin.offers.index') }}\" class=\"btn btn-secondary\">\n                            <i class=\"fas fa-cog\"></i> Manage Offers\n                        </a>\n                    </div>\n                    \n                    <hr>\n                    \n                    <h6>Debug URLs:</h6>\n                    <small>\n                        <a href=\"{{ route('shop') }}?debug=flash\" target=\"_blank\">Shop with Debug Mode</a><br>\n                        <a href=\"{{ route('home') }}?debug=flash\" target=\"_blank\">Home with Debug Mode</a>\n                    </small>\n                    \n                    <hr>\n                    \n                    <h6>Storage Info:</h6>\n                    <small>\n                        <strong>Public Path:</strong> {{ public_path('storage') }}<br>\n                        <strong>Storage Path:</strong> {{ storage_path('app/public') }}<br>\n                        <strong>Link Exists:</strong> {{ file_exists(public_path('storage')) ? 'Yes' : 'No' }}\n                    </small>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<script>\nfunction clearFlashOfferStorage() {\n    // Clear all flash offer related localStorage items\n    const keys = Object.keys(localStorage);\n    keys.forEach(key => {\n        if (key.startsWith('flash_offer_seen_')) {\n            localStorage.removeItem(key);\n        }\n    });\n    alert('Flash offer storage cleared! You can now see popups again.');\n}\n\n// Add debug info to console\nconsole.log('Flash Offer Debug Page Loaded');\nconsole.log('Active Flash Offer:', @json($activeFlashOffer));\nconsole.log('LocalStorage Flash Items:', Object.keys(localStorage).filter(k => k.startsWith('flash_offer')));\n</script>\n@endsection\n", "oldText": ""}]